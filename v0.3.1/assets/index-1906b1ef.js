var U=Object.defineProperty;var Q=(i,e,t)=>e in i?U(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var a=(i,e,t)=>(Q(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function p(i,e){let t=i.length;if(t!=e.length)return!1;for(;t--;)if(i[t]!==e[t])return!1;return!0}function M(i){if(i===null)throw TypeError("elt is null");return i}function W(i,e,t={}){let n=document.createElement(e);return i.appendChild(n),Object.entries(t).forEach(([s,o])=>n.setAttribute(s,o)),n}function N(i,e){i.classList.add("modal-contenu-animation-disparition");const t=()=>{e.style.display="none",i.classList.remove("modal-contenu-animation-disparition"),i.removeEventListener("animationend",t)};i.addEventListener("animationend",t)}function c(i){return M(document.getElementById(i))}function h(i,e){if(i===!1)throw Error(e)}const L=class{constructor(){a(this,"_fonctions_uniques",{});a(this,"_fonctions_multiples",{});a(this,"_groupes_enchasses",new Map);a(this,"_fonction_enchassee",(e,t)=>[e,t[0],t.slice(-1)[0]])}_remplit_les_vides(){typeof this._fonctions_uniques>"u"&&(this._fonctions_uniques={}),typeof this._fonctions_multiples>"u"&&(this._fonctions_multiples={}),typeof this._groupes_enchasses>"u"&&(this._groupes_enchasses=new Map)}get vide(){for(const[,e]of this._groupes_enchasses)if(!e.vide)return!1;return Object.keys(this._fonctions_uniques).length===0&&Object.keys(this._fonctions_multiples).length===0}cree_groupe_enchasse(e,t,n){const s=new A(e);return this._groupes_enchasses.set([t,n],s),s}get groupes_enchasses_nombre(){return this._groupes_enchasses.size}groupe_enchasse(e,t){let n;for(const[s,o]of this._groupes_enchasses)s[0]===e&&s[1]===t&&(n=o);if(typeof n>"u")throw Error(`Pas de groupe avec la fonction ${e} et le numéro ${t}`);return n}supprime_groupe_enchasse(e,t){for(const[n]of this._groupes_enchasses)if(n[0]===e&&n[1]===t)return this._groupes_enchasses.delete(n);return!1}fonctions_multiples_nombre(e){const t=this._fonctions_multiples;return e in t?t[e].length:0}get copie(){let e=new L;return Object.entries(this._fonctions_uniques).forEach(([t,n])=>{n.length>0&&(e._fonctions_uniques[t]=n)}),Object.entries(this._fonctions_multiples).forEach(([t,n])=>{let s=[];n.length>0&&(s=n.filter(o=>o.length>0)),s.length>0&&(e._fonctions_multiples[t]=s)}),e._groupes_enchasses=new Map([...this._groupes_enchasses.entries()].filter(t=>!t[1].vide).map(t=>[t[0],t[1].copie])),e}fonction(e){let t=[];for(const n in this._fonctions_uniques)this._fonctions_uniques[n].includes(e)&&t.push(n);for(const n in this._fonctions_multiples)for(const s of this._fonctions_multiples[n])if(s.includes(e)){t.push(n);break}for(const[,n]of this._groupes_enchasses){const s=n.fonction(e);s&&t.push(...s)}return t}fonction_detaillee(e){let t=[];for(const s in this._fonctions_uniques)this._fonctions_uniques[s].includes(e)&&t.push(this._fonction_enchassee(s,this._fonctions_uniques[s]));const n=this._fonctions_multiples;for(const s in n)for(const o of n[s])o.includes(e)&&t.push(this._fonction_enchassee(s,o));for(const[,s]of this._groupes_enchasses)t.push(...s.fonction_detaillee(e));return t.sort((s,o)=>s[2]-s[1]>o[2]-o[1]?-1:1)}fonctionPos(e,t=-1){return t>=0&&h(L.Fonctions_multiples.includes(e),`fonctionPos:  ${e} n'est pas une fonction multiple`),L.Fonctions_multiples.includes(e)?(h(t>-1,`fonctionPos: numero_de_fonction doit être supérieur à -1 pour les fonctions multiples comme ${e}`),!(e in this._fonctions_multiples)||t>=this._fonctions_multiples[e].length?[]:this._fonctions_multiples[e][t]):e in this._fonctions_uniques?this._fonctions_uniques[e]:[]}declareFonction(e,t,n=-1){if(t=t.sort((s,o)=>s-o),L.Fonctions_multiples.includes(e)){let s=this._fonctions_multiples;e in s||(h(n<=0,`declareFonction: ${n} introuvable pour ${e}`),s[e]=[]),n===-1||n===s[e].length?s[e].push(t):(h(n<s[e].length,`declareFonction: ${n} introuvable pour ${e}`),s[e][n]=t)}else this._fonctions_uniques[e]=t}};let _=L;a(_,"Fonctions_multiples",["independante","complement_circonstanciel","modalisateur","auto-enonciative","connecteur","balise_textuelle","epithete","complement_du_nom","complement_du_pronom","complement_de_l_adjectif","apposition"]),a(_,"Fonctions_contenants",["independante","sujet","cod","coi","attribut_du_sujet","attribut_du_cod","complement_circonstanciel","complement_du_verbe_impersonnel","complement_du_nom","complement_du_pronom","epithete","apposition","complement_de_l_adjectif"]);const $=class extends _{constructor(t){super();a(this,"verbes",[]);a(this,"_phrase_cassee",[]);this.phrase=t,this.phrase=t,this._cassePhrase()}get contenu(){return this.phrase}get mots_pos(){return[...Array(this._phrase_cassee.length).keys()]}set contenu(t){this.phrase=t}get copie(){let t=super.copie;return t.verbes=this.verbes,t.contenu=this.contenu,t}toJSON(){const t=this.copie;let n=Object.assign(t);return n._groupes_enchasses=Array.from(n._groupes_enchasses.entries()),n}get phraseCassee(){return this._phrase_cassee}get longueur(){return this._phrase_cassee.length}static get separateur(){return this._separateur}fonction(t){let n=super.fonction(t);return this.verbes.includes(t)&&n.push("verbes"),n}fonction_detaillee(t){let n=super.fonction_detaillee(t);return this.verbes.includes(t)&&n.push(this._fonction_enchassee("verbes",this.verbes)),n}fonctionPos(t,n=-1){return t=="verbes"?this.verbes:super.fonctionPos(t,n)}fonctionMots(t,n=-1){return n>=0&&(h(_.Fonctions_multiples.includes(t),`fonctionMots: ${t} n'est pas une fonction multiple`),h(t in this._fonctions_multiples,`fonctionMots: ${t} n'a pas été créé.`),h(n<this._fonctions_multiples[t].length,`fonctionMots: ${n} introuvable pour ${t}`)),this.fonctionPos(t,n).map(s=>this._phrase_cassee[s]).join(" ")}mots_valides(t){return t.length>0?t[0]>=0&&t[t.length-1]<this.longueur:!0}declareFonction(t,n,s=-1){h(this.mots_valides(n),`declareFonction: ${n} ne correspond pas à une liste de mots valides. La longueur est de ${this.longueur}`),t==="verbes"?this.verbes=n:super.declareFonction(t,n,s)}_cassePhrase(){this._phrase_cassee=this.phrase.split($._separateur).filter(t=>t)}};let y=$;a(y,"Separateur","[ ,;?!.'-]"),a(y,"_separateur",new RegExp($.Separateur));class b extends y{constructor(e){super(e)}static reviver(e,t){return e===""?b.fromJSON(t):t}static fromJSON(e){if(typeof e=="string")return JSON.parse(e,b.reviver);{let t=Object.create(b.prototype);const n=typeof e._groupes_enchasses>"u"?new Map:new Map(Object.entries(e._groupes_enchasses).map(o=>[o[1][0],f.fromJSON(o[1][1])]));let s=Object.assign(t,e,{_groupes_enchasses:n});return s._remplit_les_vides(),s}}cree_groupe_enchasse(e,t,n){const s=new f(e);return this._groupes_enchasses.set([t,n],s),s}groupe_enchasse(e,t){return super.groupe_enchasse(e,t)}aFonction(e){if(_.Fonctions_multiples.includes(e))return e in this._fonctions_multiples?this._fonctions_multiples[e].filter(n=>!p(n,[])).length>0:!1;const t=this.fonctionPos(e);return!p(t,[])}estFonction(e,t){return t=t.sort(),_.Fonctions_multiples.includes(e)?e in this._fonctions_multiples?this._fonctions_multiples[e].filter(n=>p(n,t)).length>0:!1:p(this.fonctionPos(e),t.sort())}*groupes_enchasses(){for(const e of this._groupes_enchasses)yield e}}class A extends _{constructor(e){super(),this._contenu=e}get copie(){let e=super.copie;return e._contenu=this._contenu,e}get mots_pos(){return this._contenu}toJSON(){let e=this.copie,t=Object.assign(e);return t._groupes_enchasses=Array.from(t._groupes_enchasses.entries()),t}mots_valides(e){if(e.length>0){for(const t of e)if(!this._contenu.includes(t))return!1}return!0}declareFonction(e,t,n=-1){h(this.mots_valides(t),`declareFonction: ${t} ne correspond pas à une liste de mots valides.`),super.declareFonction(e,t,n)}}class f extends A{static reviver(e,t){return e===""?f.fromJSON(t):t}static fromJSON(e){if(typeof e=="string")return JSON.parse(e,f.reviver);{let t=Object.create(f.prototype);const n=typeof e._groupes_enchasses>"u"?new Map:new Map(Object.entries(e._groupes_enchasses).map(o=>[o[1][0],f.fromJSON(o[1][1])]));let s=Object.assign(t,e,{_groupes_enchasses:n});return s._remplit_les_vides(),s}}cree_groupe_enchasse(e,t,n){const s=new f(e);return this._groupes_enchasses.set([t,n],s),s}aFonction(e){if(_.Fonctions_multiples.includes(e))return e in this._fonctions_multiples?this._fonctions_multiples[e].filter(n=>!p(n,[])).length>0:!1;const t=this.fonctionPos(e);return!p(t,[])}estFonction(e,t){return t=t.sort(),_.Fonctions_multiples.includes(e)?e in this._fonctions_multiples?this._fonctions_multiples[e].filter(n=>p(n,t)).length>0:!1:p(this.fonctionPos(e),t.sort())}*groupes_enchasses(){for(let e of this._groupes_enchasses)yield e}}class k extends A{constructor(e){super(e.mots_pos),this.gec=e}cree_groupe_enchasse_eleve(e,t,n){const s=new k(e);return this._groupes_enchasses.set([t,n],s),s}get corrige(){return this.gec}est_complet(e){const t=this.corrige.fonctions_multiples_nombre(e);if(t!==this.fonctions_multiples_nombre(e))return!1;const n=this._fonctions_multiples[e];for(let s=0;s<t;s++){const o=this.corrige.fonctionPos(e,s);if(n.filter(r=>p(r,o)).length===0)return!1}return!0}declare(e,t,n=-1){return _.Fonctions_multiples.includes(e)&&e in this._fonctions_multiples&&this._fonctions_multiples[e].filter(s=>p(s,t)).length!==0?!1:(this.declareFonction(e,t,n),this.corrige.estFonction(e,t))}}class m extends y{constructor(e,t){super(e),this._corrige=t,this._corrige=t}get corrige(){return this._corrige}cree_groupe_enchasse_eleve(e,t,n){const s=new k(e);return this._groupes_enchasses.set([t,n],s),s}declare(e,t,n=-1){return _.Fonctions_multiples.includes(e)&&e in this._fonctions_multiples&&this._fonctions_multiples[e].filter(s=>p(s,t)).length!==0?!1:(this.declareFonction(e,t,n),this._corrige.estFonction(e,t))}est_complet(e){const t=this._corrige.fonctions_multiples_nombre(e);if(t!==this.fonctions_multiples_nombre(e))return!1;const n=this._fonctions_multiples[e];for(let s=0;s<t;s++){const o=this._corrige.fonctionPos(e,s);if(n.filter(r=>p(r,o)).length===0)return!1}return!0}}function T(i,e){return["sujet","groupe_verbal"].includes(i)?e?"[":"]":""}function X(i,e){return e==i[1]||i[0]==="verbes"?`${T(i[0],!0)}<span class="phrase-${i[0]}">`:""}function Y(i,e){return e==i[2]||i[0]==="verbes"?`</span>${T(i[0],!1)}`:""}function J(i,e=[]){e.length===0&&(e=i.mots_pos);const t=new RegExp("("+m.Separateur+")"),n=i.contenu.split(t);let s=0,o=[];for(const l of n){if(m.Separateur.includes(l)){o.push(l);continue}const r=i.fonction_detaillee(s);r.forEach(d=>o.push(X(d,s)));const u=e.includes(s)?'class="phrase-cliquable"':'class="phrase-non-cliquable"';o.push(`<span ${u} id="phrase-mot-${s}">${l}</span>`),r.forEach(d=>o.push(Y(d,s))),s+=1}return o.join("")}Array();let q={fonction_de_validation:()=>{console.log("Problème: la fonction de validation n'a pas été mise en place")}};let x=()=>console.log("Problème: aucune fonction définie pour le bouton OK de la nouvelle phrase"),H=()=>console.log("Problème: aucune fonction définie pour la validation de la nouvelle phrase"),B=i=>console.log("Aucune fonction définie pour le sélecteur"),F=()=>(console.log("Problème: enregistre_fonction n'a pas été instancié"),new j("vide"));function Z(){c("modal-nouvelle_phrase-bouton").addEventListener("click",()=>{x()}),c("bouton-valider-phrase").addEventListener("click",()=>{H()}),c("nouvelle_phrase-fonctions-selection").addEventListener("click",i=>{B(i)})}class G{constructor(e,t,n,s,o=-1,l){a(this,"validee",!1);a(this,"est_multiple",!1);this.nom_de_base=e,this.fonction=t,this.html_node=n,this.syntagme=s,this.numero=o,this.parent=l,this.est_multiple=o>-1}get nom(){return this.numero>-1?`${this.nom_de_base}-${this.numero+1}`:this.nom_de_base}get arbre_genealogique(){return typeof this.parent>"u"?this.nom:`${this.parent.arbre_genealogique} > ${this.nom}`}get id_sous_menu(){const e=this.numero===-1?"":`-${this.numero}`,t=`${this.fonction}${e}`;return typeof this.parent>"u"?t:`${this.parent.id_sous_menu}-${t}`}}const E=class{constructor(e){a(this,"_phrase");a(this,"_traceur",[]);a(this,"_pos",0);a(this,"_selecteur",c("nouvelle_phrase-fonctions-selection"));this._phrase=new m(e,new b(e)),this._selecteur.innerHTML="",Object.entries(E.liste_des_fonctions_niveau_1).forEach(t=>this.ajouter_fonction_tracee(this._traceur.length,t[0],t[1])),this._selecteur.style.display="block"}set pos(e){this.fonction_courante.html_node.classList.remove("selectionne"),h(e<this._traceur.length,`${e} est plus grand que la longueur du traceur: ${this._traceur.length}.`),this._pos=e,this.fonction_courante.html_node.classList.add("selectionne")}get pos(){return this._pos}get fonction_courante(){return this._traceur[this._pos]}set_pos_selecteur(e,t){for(let n of e.children)n.classList.contains("selecteur")||n.classList.contains("sous_menu")?t=this.set_pos_selecteur(n,t):(n.setAttribute("pos",t.toString()),t+=1);return t}ajouter_node_selecteur(e,t,n,s){for(let o of e.children)if(o.classList.contains("sous_menu")){if(n=this.ajouter_node_selecteur(o.children[1],t,n+1,s),n>s)return n}else{if(n===s&&o.insertAdjacentElement("beforebegin",t),n>s)return n;n+=1}return n===s?(e.appendChild(t),n+1):n}ajouter_fonction_tracee(e,t,n,s=this._phrase,o=-1,l){m.Fonctions_multiples.includes(n)&&o===-1&&(o=0),h(e<=this._traceur.length,`${e} est plus grand que la longueur du traceur`);let r=document.createElement("div");const u=new G(t,n,r,s,o,l);this._traceur.splice(e,0,u),r.setAttribute("value",u.fonction),r.setAttribute("class","selecteur-element"),r.innerHTML=u.nom,this.ajouter_node_selecteur(this._selecteur,r,0,e),this.set_pos_selecteur(this._selecteur,0)}retirer_enfants(e,t,n=!1){for(const[s,o]of this._traceur.entries())o.parent===e&&(t=this.retirer_enfants(o,t,!1),o.html_node.remove(),t.push(s));return n&&(this._traceur=this._traceur.filter((s,o)=>!t.includes(o)),this.set_pos_selecteur(this._selecteur,0)),t}gere_groupe_enchasse(e,t,n){if(!m.Fonctions_contenants.includes(this.fonction_courante.fonction))return;if(!e){if(n.syntagme.supprime_groupe_enchasse(n.fonction,n.numero)){const u=c(`sous_menu-${n.id_sous_menu}`);u.insertAdjacentElement("beforebegin",n.html_node),this.retirer_enfants(n,[],!0),u.remove()}return}let s=n.syntagme.cree_groupe_enchasse(t,n.fonction,n.numero),o=document.createElement("div");o.setAttribute("class","sous_menu"),o.setAttribute("id",`sous_menu-${n.id_sous_menu}`),this.fonction_courante.html_node.insertAdjacentElement("beforebegin",o),o.insertAdjacentElement("afterbegin",this.fonction_courante.html_node);let l=document.createElement("div");l.setAttribute("class","selecteur sous_menu_contenu"),this.fonction_courante.html_node.insertAdjacentElement("afterend",l);let r=this._pos+1;Object.entries(E.liste_des_fonctions_niveau_2).concat(Object.entries(E.liste_des_fonctions_niveau_1)).forEach(u=>{this.ajouter_fonction_tracee(r,u[0],u[1],s,-1,n),r+=1}),o.addEventListener("mouseenter",()=>{l.style.display="block"}),o.addEventListener("mouseleave",()=>{l.style.display="none"})}valide_fonction(e){const t=this.fonction_courante;return t.validee=e,e?t.html_node.classList.add("valide"):t.html_node.classList.remove("valide"),e}analyse_de_fonction(e=-1){e===-1?e=this._pos:this.pos=e;const t=this.fonction_courante.fonction,n=this.fonction_courante.syntagme;c("phrase-analyse-paragraphe").innerHTML=J(this._phrase,n.mots_pos),c("consigne-container").innerHTML=`À renseigner : ${this.fonction_courante.arbre_genealogique}`;const s=this._phrase.fonctionPos(t,this.fonction_courante.numero);Array.from(document.getElementsByClassName("phrase-cliquable")).forEach(o=>{s.includes(Number(o.id.split("-")[2]))&&o.classList.add("phrase-selectionne")}),F=()=>{const o=Array.from(document.getElementsByClassName("phrase-selectionne")).map(r=>Number(r.id.split("-")[2]));if(this.fonction_courante.est_multiple&&this._phrase.fonctions_multiples_nombre(t)===this.fonction_courante.numero){if(o.length===0)return this;this.ajouter_fonction_tracee(e+1,this.fonction_courante.nom_de_base,t,n,this.fonction_courante.numero+1)}n.declareFonction(t,o,this.fonction_courante.numero);const l=this.valide_fonction(o.length>0);return this.gere_groupe_enchasse(l,o,this.fonction_courante),this},H=()=>{const o="phrase.v0.3.1.json",l=new Blob([JSON.stringify(F()._phrase)],{type:"text/json"}),r=document.createElement("a");r.download=o,r.href=window.URL.createObjectURL(l),r.dataset.downloadurl=["text/json",r.download,r.href].join(":");const u=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});r.dispatchEvent(u),r.remove(),I()},q.fonction_de_validation=()=>{F(),this.analyse_de_fonction(e+1)}}};let j=E;a(j,"liste_des_fonctions_niveau_1",{Indépendante:"independante",Sujet:"sujet",Verbes:"verbes",Noyau:"noyau","Verbe principal":"verbe_principal","Groupe verbal":"groupe_verbal",COD:"cod",COI:"coi","Attribut du sujet":"attribut_du_sujet","Attribut du COD":"attribut_du_cod","Complément d'agent":"complement_d_agent","Complément circonstanciel":"complement_circonstanciel","Complément du verbe impersonnel":"complement_du_verbe_impersonnel",Modalisateur:"modalisateur","Fonction auto-énonciative":"auto-enonciative",Connecteur:"connecteur","Balise textuelle":"balise_textuelle"}),a(j,"liste_des_fonctions_niveau_2",{Épithète:"epithete","Complément du nom":"complement_du_nom","Complément du pronom":"complement_du_pronom",Apposition:"apposition","Complément de l'adjectif":"complement_de_l_adjectif"});function I(){for(const n of M(document.getElementsByClassName("modal")))n.style.display="none";const i=c("modal-nouvelle-phrase");i.style.display="block",c("conseil").innerHTML="Sélectionnez chaque fonction comme si vous étiez vous-même l'élève. Cliquez sur valider quand vous avez terminé votre sélection. Valider dans rien sélectionner indique que cette fonction est absente de la phrase. Vous pouvez toujours corriger une éventuelle erreur en sélectionnant une fonction dans la liste déroulante.";const e=c("bouton-valider");e.style.width="50%",e.innerHTML="Valider la fonction";const t=c("bouton-valider-phrase");t.style.display="block",x=()=>{let n=c("nouvelle_phrase-texterea").value;if(n.trim()==="")return;let s=new j(n);i.style.display="none",s.analyse_de_fonction(0),B=o=>{const l=o.target;F();const r=()=>{let u=l.getAttribute("pos");return typeof u=="string"?parseInt(u):(h(!1,"la valeur de l'attribut est nulle."),-1)};s.analyse_de_fonction(r())}}}const ee=[{phrase:"Le chat mange la souris.",verbes:[2],_fonctions_uniques:{verbe_principal:[2],sujet:[0,1],cod:[3,4],groupe_verbal:[2,3,4]}},{phrase:"Marie donne du lait au chat.",verbes:[1],_fonctions_uniques:{verbe_principal:[1],sujet:[0],cod:[2,3],coi:[4,5],groupe_verbal:[1,2,3,4,5]}},{phrase:"Un véritable amant ne connaît point d'amis.",verbes:[4],_fonctions_uniques:{verbe_principal:[4],sujet:[0,1,2],coi:[6,7],groupe_verbal:[3,4,5,6,7]}},{phrase:"L'amour rend tout permis.",verbes:[2],_fonctions_uniques:{verbe_principal:[2],sujet:[0,1],cod:[3],attribut_du_cod:[4],groupe_verbal:[2,3,4]}},{phrase:"Vous êtes son rival ?",verbes:[1],_fonctions_uniques:{verbe_principal:[1],sujet:[0],attribut_du_sujet:[2,3],groupe_verbal:[1,2,3]}},{phrase:"Il est adoré d'elle.",verbes:[1,2],_fonctions_uniques:{verbe_principal:[1,2],sujet:[0],complément_d_agent:[3,4],groupe_verbal:[1,2,3,4]}}],te=ee.map(i=>b.fromJSON(i));function ne(i,e=0){return te.slice(e,e+i)}const S=[["verbes","Sélectionne les verbes."],["independante","Sélectionne une indépendante"],["verbe_principal","Sélectionne le verbe principal"],["groupe_verbal","Sélectionne le groupe verbal"],["sujet","Sélectionne le groupe sujet"],["cod","Sélectionne le Complément d'objet direct (COD)."],["coi","Sélectionne le Complément d'objet indirect (COI)."],["attribut_du_sujet","Sélectionne l'attribut du sujet."],["attribut_du_cod","Sélectionne l'attribut du COD."],["complement_d_agent","Sélectionne le complément d'agent"],["complement_circonstanciel","Sélectionne un complément circonstanciel"],["complement_du_verbe_impersonnel","Sélectionne le complément du verbe impersonnel"],["complement_du_nom","Sélectionne un complément du nom"],["complement_du_pronom","Sélectionne un complément du pronom"],["epithete","Sélectionne une épithète"],["apposition","Sélectionne une apposition"],["complement_de_l_adjectif","Sélectionne un complément de l'adjectif"],["modalisateur","Sélectionne un modalisateur"],["auto-enonciative","Sélectionne une fonction auto-énonciative"],["connecteur","Sélectionne un connecteur"],["balise_textuelle","Sélectionne une balise textuelle"]];function K(i){let e=new m(i.contenu,i);w(0,e,e,[])}function w(i,e,t,n,s=-1){const o=S[i][0];m.Fonctions_multiples.includes(o)&&s===-1&&(s=0);const l=S[i][1]+(s>=0?` (${s+1})`:"");function r(){if(i===S.length-1){let u=e.corrige.groupes_enchasses();n.push(u);for(let d=n.length-1;d>=0;d--){let g=n[d].next();if(g.done===!1){const[[O,V],D]=g.value;return w(0,e.cree_groupe_enchasse_eleve(D,O,V),t,n)}else n.pop()}return se()}else{const u=m.Fonctions_multiples.includes(o)&&!e.est_complet(o)?0:1;return s=u===0?s+1:-1,w(i+u,e,t,n,s)}}if(!e.corrige.aFonction(o))return r();c("consigne-container").innerHTML=`${l}`,c("phrase-analyse-paragraphe").innerHTML=J(t),q.fonction_de_validation=()=>{const u=Array.from(document.getElementsByClassName("phrase-selectionne")).map(g=>Number(g.id.split("-")[2]));if(u.length===0?!e.corrige.aFonction(o):e.declare(o,u,s))r();else{const g=c("modal-message-contenu");g.classList.add("modal-message-erreur"),v("Il y a une erreur dans ton analyse !","Reprendre l'analyse",()=>{w(i,e,t,n,s),g.classList.remove("modal-message-erreur"),Array.from(document.getElementsByClassName("phrase-cliquable")).forEach(O=>{u.includes(Number(O.id.split("-")[2]))&&O.classList.add("phrase-selectionne")})})}}}function v(i,e,t){const n=c("modal-message"),s=c("modal-message-contenu-texte"),o=c("modal-message-bouton");s.innerHTML=i,o.innerHTML=e,n.style.display="block",R=()=>{N(c("modal-message-contenu"),n),t()}}function se(){v("Bravo !","Commencer une autre analyse",z)}function z(){const i=c("modal-choix-phrase");i.style.display="block";const e=ne(5,0),t=c("modal-choix-phrase-liste");t.innerHTML="";for(let n in e){const s=e[n],o=W(t,"li",{id:`modal-choix-phrase-liste-${n}`});o.innerHTML=s.contenu,o.addEventListener("click",()=>{K(e[n]),N(c("modal-choix-phrase-contenu"),i)})}}let P=!1;const C=c("phrase-analyse-paragraphe");C.addEventListener("mousedown",i=>{const e=i.target;i.button!=0||!e.classList.contains("phrase-cliquable")||(P=!0,e.classList.toggle("phrase-selectionne"))});C.addEventListener("mouseover",i=>{const e=i.target;P&&e.classList.contains("phrase-cliquable")&&e.classList.toggle("phrase-selectionne")});C.addEventListener("mouseup",i=>{P=!1});c("bouton-valider").addEventListener("click",()=>{q.fonction_de_validation()});document.onkeyup=function(i){i.which===13&&q.fonction_de_validation()};let R=()=>console.log("Problème: aucune fonction définie pour le bouton du message");c("modal-message-bouton").addEventListener("click",()=>{R()});c("nouvelle_phrase").addEventListener("click",()=>{I()});c("analyse_fichier").addEventListener("click",()=>{for(const i of M(document.getElementsByClassName("modal")))i.style.display="none";c("modal-analyse-fichier").style.display="block"});c("analyse_fichier_input").addEventListener("change",i=>{const e=i.target,t=new FileReader,n=()=>{N(c("modal-analyse-fichier-contenu"),c("modal-analyse-fichier"))};if(e.files.length==0)return n(),v("Pas de fichier chargé.","OK",()=>{});const s=e.files[0];if(!(s.type?s.type:"Introuvable").includes("json"))return n(),v("Format invalide","OK",()=>{});t.addEventListener("load",o=>{const l=t.result??"";if(typeof l!="string"||l==="")return n(),v("Fichier invalide","OK",()=>{});try{K(b.fromJSON(l))}catch(r){return console.log(r),n(),r instanceof TypeError?v("Ce fichier n'est pas compatible avec la version actuelle du programme.","OK",()=>{}):v("Fichier invalide","OK",()=>{})}n()}),t.readAsText(s)});Z();z();
